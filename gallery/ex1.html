<html>
   <head>
      <style>
         #screen
         {
            position:absolute;
            height:500px;
            width:1000px;
            clip:rect(0px,1002px,502px,0px);
            border:black 1px solid;
         }
      </style>

      <script type="text/javascript" src = "canvimation_functions.js" ></script>
      <!--[IF IE]><script type="text/javascript" src = "excanvas.js" ></script><![endif]-->
      <script type="text/javascript">
         ieb=navigator.appName=="Microsoft Internet Explorer";
         var scenes = {}
         var sprites = {}
         var tracks = {}
         var frames = {}

         if(typeof String.prototype.trim !== "function")
         {
            String.prototype.trim = function()
            {
               return this.replace(/^s+|s+$/g, ""); 
            }
         }
         
         if(!Array.indexOf)
         {
            Array.prototype.indexOf = function(obj)
            {
               for(var i=0; i<this.length; i++)
               {
                  if(this[i]==obj)
                  {
                     return i;
                  }
               }
               return -1;
            }
         }
         
         function $(id)
         {
            return document.getElementById(id);
         }

         film =
         {
            name:"Film1",
            list:[
               ["SP","Sprite1",0,"ever",0,"ever",0,false]
            ]
         }

//Film Element Sprite1**********************************************
         cars=[]
         
   //scene frame start..................................
         
         frames["shape1"] =
         {
            id:"shape1",
            parent:"filmdivSprite1",
            path:["closed","shape","square",["M",218,43,],["L",253,43,],["L",253,78,],["L",218,78,],["L",218,43,]],
            width:1338,
            height:519,
            bleft:218,
            btop:43,
            bwidth:35,
            bheight:35,
            scleft:218,
            sctop:43,
            scx:1,
            scy:1,
            sox:0,
            soy:0,
            ox:0,
            oy:0,
            cx:0,
            cy:0,
            rr:100,
            phi:0,
            rotated:false,
            ratio:1,
            strokeStyle:[0,0,0,1],
            fillStyle:[255,255,255,1],
            lineWidth:1,
            lineCap:"butt",
            lineJoin:"miter",
            justfill:true,
            linearfill:true,
            lineGrad:[0,0,0,0],
            radGrad:[10,10,0,10,20,10],
            colorStops:[[0,0,0,0,0],[1,0,0,0,0]],
            stopn:0,
            shadow:false,
            shadowOffsetX:15,
            shadowOffsetY:15,
            shadowBlur:0,
            shadowColor:[0,0,0,0],
            ScaleX:1,
            ScaleY:1,
            zIndex:10000002,
            rotate:0,
            clockw:true,
            complete:false,
            beztypes:[],
            radius:10
         }
         var frame=frames["shape1"];
         cars.push(frame)
         
   //scene frame end..................................
         
         scenes["Scenery1"] = 
         {
            name:"Scenery1",
            cars:cars
         }
         
   //track frame start..................................
         
         frames["edit6"] =
         {
            id:"edit6",
            parent:"filmdivSprite1",
            path:["open","edit","curve",["M",244,416,],["B",261,396,291.98495005460944,387.1562785151046,309,388,],["B",326.01504994539056,388.8437214848954,347.4157199429143,422.28826688618176,365,422,],["B",382.5842800570857,421.71173311381824,387,393,431,386,]],
            width:1338,
            height:519,
            bleft:244,
            btop:386,
            bwidth:187,
            bheight:36,
            scleft:244,
            sctop:386,
            scx:1,
            scy:1,
            sox:0,
            soy:0,
            ox:0,
            oy:0,
            cx:0,
            cy:0,
            rr:100,
            phi:0,
            rotated:false,
            ratio:1,
            strokeStyle:[0,0,0,1],
            fillStyle:[255,255,255,1],
            lineWidth:1,
            lineCap:"butt",
            lineJoin:"miter",
            justfill:true,
            linearfill:true,
            lineGrad:[0,0,0,0],
            radGrad:[10,10,0,10,20,10],
            colorStops:[[0,0,0,0,0],[1,0,0,0,0]],
            stopn:0,
            shadow:false,
            shadowOffsetX:15,
            shadowOffsetY:15,
            shadowBlur:0,
            shadowColor:[0,0,0,0],
            ScaleX:1,
            ScaleY:1,
            zIndex:10000025,
            rotate:0,
            clockw:true,
            complete:true,
            beztypes:["corner","smooth","smooth","corner"],
            radius:10
         }
         var frame=frames["edit6"];
         
   //track frame end..................................
         
         tracks["Track1"] = 
         {
            name:"Track1",
            line:frame,
            repeats:"c",
            visible:true,
            yoyo:false
         }
         
         sprites["Sprite1"] =
         {
            name:"Sprite1",
            engine:"scene",
            ptime:5,
            pointer:1,
            points:[
               {x:244,y:416,phi:5.416883044626907},
               {x:245.61473093678603,y:414.1749463172089,phi:5.4563132366801845},
               {x:247.29970350437145,y:412.41291068792424,phi:5.494315647182948},
               {x:249.05047335573423,y:410.7137153382653,phi:5.530920481318634},
               {x:250.86259614385233,y:409.077182494351,phi:5.566170578473887},
               {x:252.73162752170367,y:407.5031343823006,phi:5.60011894746036},
               {x:254.65312314226625,y:405.99139322823305,phi:5.63282658436084},
               {x:256.62263865851804,y:404.5417812582679,phi:5.664360602191404},
               {x:258.63572972343684,y:403.1541206985237,phi:5.694792678470838},
               {x:260.6879519900008,y:401.8282337751198,phi:5.724197810962469},
               {x:262.77486111118776,y:400.5639427141755,phi:5.7526533621949225},
               {x:264.8920127399757,y:399.3610697418098,phi:5.780238368600958},
               {x:267.03496252934264,y:398.2194370841416,phi:5.807033089016184},
               {x:269.1992661322664,y:397.1388669672904,phi:5.833118768808856},
               {x:271.38047920172505,y:396.119181617375,phi:5.858577599250046},
               {x:273.5741573906964,y:395.1602032605146,phi:5.883492856292409},
               {x:275.77585635215854,y:394.26175412282845,phi:5.907949208327923},
               {x:277.9811317390893,y:393.4236564304354,phi:5.932033188546016},
               {x:280.1855392044668,y:392.64573240945487,phi:5.955833834175052},
               {x:282.3846344012689,y:391.9278042860058,phi:5.979443502261254},
               {x:284.57397298247355,y:391.2696942862074,phi:6.002958879943557},
               {x:286.74911060105865,y:390.6712246361788,phi:6.026482216770217},
               {x:288.9056029100023,y:390.132217562039,phi:6.0501228179566215},
               {x:291.0390055622823,y:389.65249528990716,phi:6.073998851241396},
               {x:293.1448742108767,y:389.23188004590247,phi:6.098239536977204},
               {x:295.21876450876334,y:388.870194056144,phi:6.122987812321372},
               {x:297.25623210892036,y:388.56725954675085,phi:6.148403587125784},
               {x:299.2528326643255,y:388.3228987438421,phi:6.174667742832296},
               {x:301.2041218279569,y:388.13693387353703,phi:6.201987067927032},
               {x:303.10565525279236,y:388.00918716195446,phi:6.230600375638143},
               {x:304.95298859181,y:387.9394808352139,phi:6.260786111927089},
               {x:306.7416774979876,y:387.9276371194342,phi:0.009686524899325633},
               {x:308.46727762430316,y:387.97347824073455,phi:0.04406068656211701},
               {x:310.1719521183481,y:388.0524823614339,phi:0.08818135931534382},
               {x:311.9087931941691,y:388.3113199268561,phi:0.2044481537815459},
               {x:313.6698492856402,y:388.7727706215049,phi:0.3047929682898997},
               {x:315.45354769196547,y:389.4215567805056,phi:0.3898689976195413},
               {x:317.2583157123489,y:390.2424007389828,phi:0.46117196811012223},
               {x:319.0825806459949,y:391.2200248320617,phi:0.5204663661689023},
               {x:320.92476979210693,y:392.3391513948671,phi:0.5694603612658417},
               {x:322.7833104498893,y:393.5845027625236,phi:0.6096594701385508},
               {x:324.656629918546,y:394.9408012701564,phi:0.6423226668317913},
               {x:326.54315549728125,y:396.39276925289056,phi:0.6684680264727143},
               {x:328.44131448529885,y:397.9251290458507,phi:0.6888977416270492},
               {x:330.3495341818028,y:399.52260298416184,phi:0.7042273645067922},
               {x:332.2662418859973,y:401.16991340294874,phi:0.7149125103515273},
               {x:334.1898648970864,y:402.85178263733667,phi:0.7212704649407397},
               {x:336.1188305142741,y:404.55293302245025,phi:0.7234960512671998},
               {x:338.05156603676426,y:406.2580868934144,phi:0.721671857821209},
               {x:339.9864987637611,y:407.9519665853541,phi:0.7157731264900391},
               {x:341.92205599446874,y:409.6192944333943,phi:0.7056675595422877},
               {x:343.8566650280909,y:411.24479277265976,phi:0.6911102042108184},
               {x:345.788753163832,y:412.8131839382756,phi:0.6717335290061991},
               {x:347.7167477008957,y:414.3091902653665,phi:0.6470329522514182},
               {x:349.63907593848626,y:415.7175340890575,phi:0.6163486378753812},
               {x:351.5541651758077,y:417.02293774447344,phi:0.5788457258475399},
               {x:353.460442712064,y:418.2101235667393,phi:0.5334979933557241},
               {x:355.35633584645916,y:419.26381389098003,phi:0.4790853157374203},
               {x:357.2402718781974,y:420.1687310523204,phi:0.4142245411411834},
               {x:359.1106781064825,y:420.90959738588543,phi:0.33746709379941353},
               {x:360.9659818305187,y:421.47113522679996,phi:0.24751133276604742},
               {x:362.80461034950986,y:421.8380669101889,phi:0.14357882676779898},
               {x:364.62499096266015,y:421.9951147711772,phi:0.02595791307861667},
               {x:366.0543034735284,y:421.9018888351445,phi:6.156054108774974},
               {x:367.3435812340802,y:421.68057131299724,phi:6.0703008637618945},
               {x:368.59261130815514,y:421.3553956875077,phi:5.987197155780838},
               {x:369.8070625990454,y:420.9316973970686,phi:5.908761250822589},
               {x:370.99260401004307,y:420.41481188007236,phi:5.836585813392792},
               {x:372.1549044444401,y:419.8100745749114,phi:5.771742581802357},
               {x:373.2996328055288,y:419.12282091997866,phi:5.714794859099181},
               {x:374.43245799660116,y:418.35838635366645,phi:5.665882710212035},
               {x:375.5590489209493,y:417.5221063143675,phi:5.624837690741989},
               {x:376.6850744818651,y:416.61931624047406,phi:5.591294145171864},
               {x:377.81620358264115,y:415.65535157037897,phi:5.564779757778483},
               {x:378.9581051265692,y:414.63554774247484,phi:5.544780638244221},
               {x:380.1164480169414,y:413.565240195154,phi:5.530783361029631},
               {x:381.2969011570499,y:412.44976436680923,phi:5.522299087633368},
               {x:382.5051334501867,y:411.294455695833,phi:5.518875059883498},
               {x:383.7468137996441,y:410.10464962061786,phi:5.520097837979244},
               {x:385.02761110871415,y:408.8856815795565,phi:5.52559151351328},
               {x:386.3531942806886,y:407.64288701104124,phi:5.535013125954849},
               {x:387.72923221886015,y:406.3816013534649,phi:5.548046756836006},
               {x:389.16139382652034,y:405.10716004521987,phi:5.564397256142074},
               {x:390.6553480069616,y:403.8248985246988,phi:5.583784217763972},
               {x:392.216763663476,y:402.5401522302942,phi:5.605936609129289},
               {x:393.8513096993556,y:401.2582566003988,phi:5.630588326988784},
               {x:395.5646550178924,y:399.9845470734049,phi:5.65747486109387},
               {x:397.36246852237866,y:398.72435908770524,phi:5.686331175355493},
               {x:399.25041911610634,y:397.4830280816924,phi:5.71689084676177},
               {x:401.2341757023676,y:396.2658894937589,phi:5.748886428896682},
               {x:403.31940718445463,y:395.0782787622972,phi:5.782050929494536},
               {x:405.5117824656594,y:393.92553132570004,phi:5.816120215778882},
               {x:407.81697044927404,y:392.81298262235987,phi:5.850836096441293},
               {x:410.24064003859075,y:391.7459680906694,phi:5.885949784757737},
               {x:412.78846013690156,y:390.729823169021,phi:5.9212254311335855},
               {x:415.4660996474986,y:389.7698832958074,phi:5.956443428572503},
               {x:418.2792274736738,y:388.87148390942104,phi:5.991403239039466},
               {x:421.2335125187195,y:388.03996044825453,phi:6.02592555531708},
               {x:424.3346236859277,y:387.2806483507005,phi:6.059853691340141},
               {x:427.58822987859054,y:386.5988830551515,phi:6.093054172841689},
               {x:431,y:386,phi:6.125416569583632},
            ],
            vec:true,
            vector:
            {
               xs:217,
               xe:317,
               ys:78,
               ye:78,
               psi:0
            },
            train:scenes["Scenery1"],
            track:tracks["Track1"],
         }

         sprite=sprites["Sprite1"];
         sprite.cars = sprite.train.cars;

         function startfilm()
         {
            $("screen").style.left=0; // change to move screen position
            $("screen").style.top=0; // change to move screen position
            for (var i=0; i<film.list.length; i++)
            {
               filmdiv = document.createElement("div");
               filmdiv.id = "filmdiv"+film.list[i][1];
               filmdiv.style.position = "absolute";
               filmdiv.style.left = 0;
               filmdiv.style.top = 0;
               filmdiv.style.zIndex = film.list[i][6];
               $("screen").appendChild(filmdiv);
            }
            for (var fr in frames)
            {
               frame = frames[fr];
               canvas = document.createElement("canvas");
               canvas.style.position="absolute";
               canvas.style.top=-4;
               canvas.style.left=-183;
               canvas.width = frame.width;
               canvas.height = frame.height;
               canvas.style.zIndex = frame.zIndex;
               $(frame.parent).appendChild(canvas);
               if (ieb) {canvas=G_vmlCanvasManager.initElement(canvas)}
               if (canvas.getContext)
               {
                  canvas.ctx = canvas.getContext("2d");
                  canvas.ctx.scale(1,1);
               }
               frame.ctx=canvas.ctx;
               canvas.frame=frame;
            }
            showfilm();
         }
      </script>
   </head>

   <body onload="startfilm()">
      <div id="screen"></div>
   </body>
</html>
